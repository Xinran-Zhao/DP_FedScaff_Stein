(scaffold) xzhao181@en4228312l:~/DP_FedScaff_Stein$ python ./src/server/scaffold.py --dataset mnist --clip_bound=100 --global_epochs=100 --local_epochs=20 --dp_sigma=0.3
/home/local/ASURITE/xzhao181/DP_FedScaff_Stein/src/server/base.py:68: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.global_params_dict = torch.load(self.temp_dir / "global_model.pt")
Find existed global model...                                                                                                                                                 
Have run 0 epochs already.                                                                                                                                                   
Backbone: LeNet5(                                                                                                                                                            
  (net): Sequential(                                                                                                                                                         
    (0): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))                                                                                                                     
    (1): ReLU(inplace=True)                                                                                                                                                  
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)                                                                                          
    (3): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))                                                                                                                    
    (4): ReLU(inplace=True)                                                                                                                                                  
    (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)                                                                                          
    (6): Flatten(start_dim=1, end_dim=-1)                                                                                                                                    
    (7): Linear(in_features=256, out_features=120, bias=True)                                                                                                                
    (8): ReLU(inplace=True)                                                                                                                                                  
    (9): Linear(in_features=120, out_features=84, bias=True)                                                                                                                 
    (10): ReLU(inplace=True)                                                                                                                                                 
    (11): Linear(in_features=84, out_features=10, bias=True)                                                                                                                 
  )                                                                                                                                                                          
)                                                                                                                                                                            
Arguments:                                                                                                                                                                   
{                                                                                                                                                                            
    'global_epochs': 100,                                                                                                                                                    
    'local_epochs': 20,                                                                                                                                                      
    'local_lr': 0.01,                                                                                                                                                        
    'verbose_gap': 5,                                                                                                                                                        
    'dataset': 'mnist',                                                                                                                                                      
    'batch_size': -1,                                                                                                                                                        
    'gpu': 1,                                                                                                                                                                
    'log': 0,                                                                                                                                                                
    'seed': 17,                                                                                                                                                              
    'client_num_per_round': 5,                                                                                                                                               
    'save_period': 5,                                                                                                                                                        
    'dp_sigma': 0.3,                                                                                                                                                         
    'clip_bound': 100.0,                                                                                                                                                     
    'jse': False                                                                                                                                                             
}                                                                                                                                                                            
============================== TRAINING ==============================                                                                                                       
============================== ROUND: 0 ==============================                                                                                                       
client [3]   loss: 187425.5921 -> 356683.1253    accuracy: 10.26% -> 29.79%                                                                                                  
client [4]   loss: 108141.5897 -> 19929537.6123    accuracy: 1.75% -> 34.50%                                                                                                 
client [0]   loss: 207631.3248 -> 206974.0767    accuracy: 1.53% -> 15.60%                                                                                                   
client [1]   loss: 209320.7005 -> 1915723.5023    accuracy: 20.01% -> 29.10%                                                                                                 
client [2]   loss: 120039.9366 -> 229624.3910    accuracy: 1.39% -> 27.34%                                                                                                   
============================== ROUND: 5 ==============================                                                                                                       
client [4]   loss: 3.9495 -> 50.9779    accuracy: 5.19% -> 10.33%                                                                                                            
client [0]   loss: 3.5240 -> 4.3483    accuracy: 1.53% -> 5.88%                                                                                                              
client [1]   loss: 3.6050 -> 101.1006    accuracy: 12.90% -> 2.30%                                                                                                           
client [2]   loss: 3.5043 -> 3.4618    accuracy: 0.13% -> 0.07%                                                                                                              
client [3]   loss: 2.7470 -> 3.0693    accuracy: 36.61% -> 28.75%                                                                                                            
============================== ROUND: 10 ==============================                                                                                                      
client [4]   loss: 3.6833 -> 5.3067    accuracy: 1.29% -> 12.03%                                                                                                             
client [1]   loss: 2.6350 -> 3.7903    accuracy: 6.91% -> 4.54%                                                                                                              
client [0]   loss: 3.0715 -> 62.7320    accuracy: 0.26% -> 1.79%                                                                                                             
client [2]   loss: 4.2827 -> 4.2111    accuracy: 0.00% -> 0.20%                                                                                                              
client [3]   loss: 2.3188 -> 3.1137    accuracy: 36.12% -> 25.49%                                                                                                            
============================== ROUND: 15 ==============================                                                                                                      
client [1]   loss: 3.2485 -> 4.1365    accuracy: 4.61% -> 6.32%                                                                                                              
client [4]   loss: 4.3856 -> 5.8375    accuracy: 0.57% -> 1.90%                                                                                                              
client [0]   loss: 3.1823 -> 4.9472    accuracy: 0.26% -> 1.28%                                                                                                              
client [2]   loss: 3.2950 -> 3.4417    accuracy: 0.07% -> 0.00%                                                                                                              
client [3]   loss: 2.8997 -> 4.4305    accuracy: 41.22% -> 34.34%                                                                                                            
============================== ROUND: 20 ==============================                                                                                                      
client [2]   loss: 4.1310 -> 4.4441    accuracy: 0.13% -> 2.44%                                                                                                              
client [0]   loss: 4.0942 -> 6.4775    accuracy: 4.35% -> 4.35%                                                                                                              
client [1]   loss: 5.2146 -> 8.9944    accuracy: 3.49% -> 0.99%                                                                                                              
client [4]   loss: 4.8538 -> 8.6176    accuracy: 3.86% -> 3.29%                                                                                                              
client [3]   loss: 5.1052 -> 5.8738    accuracy: 37.29% -> 45.15%                                                                                                            
============================== ROUND: 25 ==============================                                                                                                      
client [4]   loss: 5.6050 -> 7.6439    accuracy: 4.99% -> 7.56%                                                                                                              
client [0]   loss: 5.6296 -> 5.3456    accuracy: 1.02% -> 5.88%                                                                                                              
client [1]   loss: 6.2966 -> 8.9805    accuracy: 0.53% -> 1.45%                                                                                                              
client [3]   loss: 6.2630 -> 7.3035    accuracy: 40.17% -> 41.09%                                                                                                            
client [2]   loss: 3.5966 -> 4.2997    accuracy: 0.07% -> 0.07%                                                                                                              
============================== ROUND: 30 ==============================                                                                                                      
client [3]   loss: 5.7300 -> 8.5485    accuracy: 36.98% -> 33.35%                                                                                                            
client [1]   loss: 5.1383 -> 6.9709    accuracy: 0.59% -> 0.20%                                                                                                              
client [0]   loss: 3.2019 -> 3.2214    accuracy: 0.51% -> 5.12%                                                                                                              
client [4]   loss: 6.5655 -> 8.6905    accuracy: 0.57% -> 0.98%                                                                                                              
client [2]   loss: 3.9556 -> 5.5311    accuracy: 1.25% -> 0.99%                                                                                                              
============================== ROUND: 35 ==============================                                                                                                      
client [0]   loss: 3.6658 -> 6.8434    accuracy: 3.58% -> 4.09%                                                                                                              
client [3]   loss: 7.2330 -> 10.9028    accuracy: 26.41% -> 35.26%                                                                                                           
client [2]   loss: 3.6784 -> 4.7015    accuracy: 0.79% -> 1.06%                                                                                                              
client [1]   loss: 4.9128 -> 13.0763    accuracy: 5.60% -> 42.59%                                                                                                            
client [4]   loss: 6.3791 -> 9.7504    accuracy: 1.44% -> 1.08%                                                                                                              
============================== ROUND: 40 ==============================                                                                                                      
client [2]   loss: 3.2117 -> 3.0819    accuracy: 0.13% -> 1.25%                                                                                                              
client [3]   loss: 4.9234 -> 7.2831    accuracy: 1.04% -> 3.81%                                                                                                              
client [4]   loss: 5.1778 -> 8.4799    accuracy: 1.90% -> 6.74%                                                                                                              
client [1]   loss: 4.0537 -> 7.2363    accuracy: 43.84% -> 0.99%                                                                                                             
client [0]   loss: 3.0313 -> 3.9279    accuracy: 3.32% -> 1.53%                                                                                                              
============================== ROUND: 45 ==============================                                                                                                      
client [1]   loss: 5.5205 -> 7.3953    accuracy: 6.12% -> 6.39%                                                                                                              
client [3]   loss: 4.4489 -> 8.9716    accuracy: 35.87% -> 32.86%                                                                                                            
client [2]   loss: 3.1000 -> 3.0101    accuracy: 0.33% -> 40.03%                                                                                                             
client [4]   loss: 4.8197 -> 4.7797    accuracy: 0.41% -> 2.57%                                                                                                              
client [0]   loss: 3.1944 -> 2.9287    accuracy: 1.79% -> 2.56%                                                                                                              
============================== ROUND: 50 ==============================                                                                                                      
client [1]   loss: 13.1482 -> 15.0959    accuracy: 1.32% -> 10.66%                                                                                                           
client [0]   loss: 6.8721 -> 4.7313    accuracy: 4.35% -> 0.77%                                                                                                              
client [2]   loss: 4.3613 -> 7.2878    accuracy: 0.07% -> 0.26%                                                                                                              
client [3]   loss: 9.0080 -> 5.9733    accuracy: 41.15% -> 30.90%                                                                                                            
client [4]   loss: 7.5404 -> 8.8113    accuracy: 0.51% -> 33.93%                                                                                                             
============================== ROUND: 55 ==============================                                                                                                      
client [1]   loss: 7.9404 -> 13.7521    accuracy: 0.79% -> 0.99%                                                                                                             
client [2]   loss: 3.3015 -> 4.3362    accuracy: 0.00% -> 0.46%                                                                                                              
client [3]   loss: 7.2746 -> 8.9392    accuracy: 42.32% -> 42.26%                                                                                                            
client [4]   loss: 6.1307 -> 8.3538    accuracy: 0.41% -> 0.62%                                                                                                              
client [0]   loss: 3.2118 -> 4.1554    accuracy: 0.51% -> 51.66%                                                                                                             
============================== ROUND: 60 ==============================                                                                                                      
client [2]   loss: 3.2179 -> 4.3783    accuracy: 0.26% -> 0.00%                                                                                                              
client [0]   loss: 3.5461 -> 5.4601    accuracy: 2.56% -> 2.30%                                                                                                              
client [3]   loss: 5.4651 -> 8.7976    accuracy: 47.91% -> 38.70%                                                                                                            
client [1]   loss: 11.7344 -> 15.8298    accuracy: 0.59% -> 0.66%                                                                                                            
client [4]   loss: 7.2467 -> 8.7874    accuracy: 2.06% -> 12.96%                                                                                                             
============================== ROUND: 65 ==============================                                                                                                      
client [0]   loss: 3.3124 -> 208.3574    accuracy: 0.51% -> 1.02%                                                                                                            
client [3]   loss: 3.7482 -> 6.8075    accuracy: 0.06% -> 0.31%                                                                                                              
client [1]   loss: 10.9641 -> 10.9751    accuracy: 0.13% -> 0.00%                                                                                                            
client [2]   loss: 2.7928 -> 3.8278    accuracy: 55.35% -> 55.35%                                                                                                            
client [4]   loss: 5.2898 -> 7.0556    accuracy: 0.98% -> 1.49%                                                                                                              
============================== ROUND: 70 ==============================                                                                                                      
client [3]   loss: 7.4010 -> 10.6014    accuracy: 0.12% -> 1.72%                                                                                                             
client [0]   loss: 5.0015 -> 9.9154    accuracy: 0.26% -> 8.18%                                                                                                              
client [4]   loss: 3.9786 -> 4.3847    accuracy: 2.83% -> 2.01%                                                                                                              
client [1]   loss: 10.1560 -> 10.9149    accuracy: 0.46% -> 0.66%                                                                                                            
client [2]   loss: 3.1615 -> 3.4978    accuracy: 55.15% -> 55.88%                                                                                                            
============================== ROUND: 75 ==============================                                                                                                      
client [3]   loss: 4.3990 -> 7.0375    accuracy: 0.00% -> 14.62%                                                                                                             
client [4]   loss: 4.7439 -> 5.5810    accuracy: 0.46% -> 1.90%                                                                                                              
client [1]   loss: 7.9269 -> 11.3280    accuracy: 0.13% -> 21.99%                                                                                                            
client [0]   loss: 4.3240 -> 5.3761    accuracy: 0.26% -> 56.78%                                                                                                             
client [2]   loss: 3.3831 -> 3.4986    accuracy: 55.35% -> 55.48%                                                                                                            
============================== ROUND: 80 ==============================                                                                                                      
client [3]   loss: 4.2755 -> 5.4993    accuracy: 0.12% -> 0.12%                                                                                                              
client [1]   loss: 10.5848 -> 13.9861    accuracy: 0.33% -> 2.70%                                                                                                            
client [2]   loss: 3.1708 -> 6.7102    accuracy: 55.35% -> 55.48%                                                                                                            
client [0]   loss: 9.7208 -> 8.1270    accuracy: 0.00% -> 5.12%                                                                                                              
client [4]   loss: 5.1112 -> 7.4189    accuracy: 0.46% -> 0.51%                                                                                                              
============================== ROUND: 85 ==============================                                                                                                      
client [3]   loss: 5.2050 -> 10.6739    accuracy: 40.85% -> 0.25%                                                                                                            
client [2]   loss: 7.9425 -> 7.2629    accuracy: 0.00% -> 55.28%                                                                                                             
client [0]   loss: 7.7064 -> 7.2557    accuracy: 2.56% -> 5.37%                                                                                                              
client [4]   loss: 5.9424 -> 4.5663    accuracy: 0.31% -> 34.65%                                                                                                             
client [1]   loss: 9.7966 -> 7.1545    accuracy: 0.46% -> 25.41%                                                                                                             
============================== ROUND: 90 ==============================                                                                                                      
client [4]   loss: 5.7682 -> 8.9418    accuracy: 0.31% -> 33.57%                                                                                                             
client [2]   loss: 3.0119 -> 5.4795    accuracy: 55.35% -> 0.13%                                                                                                             
client [1]   loss: 9.9720 -> 9.3830    accuracy: 0.13% -> 0.33%                                                                                                              
client [0]   loss: 7.3917 -> 11.4671    accuracy: 0.51% -> 6.65%                                                                                                             
client [3]   loss: 5.0771 -> 8.6331    accuracy: 0.00% -> 0.74%                                                                                                              
============================== ROUND: 95 ==============================                                                                                                      
client [2]   loss: 2.8926 -> 4.1789    accuracy: 55.42% -> 0.20%                                                                                                             
client [3]   loss: 3.8864 -> 3.8537    accuracy: 0.06% -> 0.12%                                                                                                              
client [0]   loss: 2.5177 -> 2.1072    accuracy: 0.77% -> 1.53%                                                                                                              
client [1]   loss: 8.9711 -> 12.0622    accuracy: 0.33% -> 0.13%                                                                                                             
client [4]   loss: 6.9925 -> 6.2485    accuracy: 0.10% -> 0.21%                                                                                                              
Training... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:02:54
============================== TESTING ==============================                                                                                                        
Testing... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:01
==================== RESULTS ====================                                                                                                                            
loss: 6.9442    accuracy: 12.15%                                                                                                                                             
SCAFFOLD achieved 10.0% accuracy(12.88%) at epoch: 5                                                                                                                         
(scaffold) xzhao181@en4228312l:~/DP_FedScaff_Stein$ python ./src/server/scaffold.py --dataset mnist --clip_bound=100 --global_epochs=100 --local_epochs=20 --dp_sigma=0.3 --jse=True
Backbone: LeNet5(                                                                                                                                                            
  (net): Sequential(                                                                                                                                                         
    (0): Conv2d(1, 6, kernel_size=(5, 5), stride=(1, 1))                                                                                                                     
    (1): ReLU(inplace=True)                                                                                                                                                  
    (2): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)                                                                                          
    (3): Conv2d(6, 16, kernel_size=(5, 5), stride=(1, 1))                                                                                                                    
    (4): ReLU(inplace=True)                                                                                                                                                  
    (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)                                                                                          
    (6): Flatten(start_dim=1, end_dim=-1)                                                                                                                                    
    (7): Linear(in_features=256, out_features=120, bias=True)                                                                                                                
    (8): ReLU(inplace=True)                                                                                                                                                  
    (9): Linear(in_features=120, out_features=84, bias=True)                                                                                                                 
    (10): ReLU(inplace=True)                                                                                                                                                 
    (11): Linear(in_features=84, out_features=10, bias=True)                                                                                                                 
  )                                                                                                                                                                          
)                                                                                                                                                                            
Arguments:                                                                                                                                                                   
{                                                                                                                                                                            
    'global_epochs': 100,                                                                                                                                                    
    'local_epochs': 20,                                                                                                                                                      
    'local_lr': 0.01,                                                                                                                                                        
    'verbose_gap': 5,                                                                                                                                                        
    'dataset': 'mnist',                                                                                                                                                      
    'batch_size': -1,                                                                                                                                                        
    'gpu': 1,                                                                                                                                                                
    'log': 0,                                                                                                                                                                
    'seed': 17,                                                                                                                                                              
    'client_num_per_round': 5,                                                                                                                                               
    'save_period': 5,                                                                                                                                                        
    'dp_sigma': 0.3,                                                                                                                                                         
    'clip_bound': 100.0,                                                                                                                                                     
    'jse': True                                                                                                                                                              
}                                                                                                                                                                            
============================== TRAINING ==============================                                                                                                       
============================== ROUND: 0 ==============================                                                                                                       
client [3]   loss: 10.9515 -> 1.3190    accuracy: 0.00% -> 42.81%                                                                                                            
client [4]   loss: 3.3307 -> 0.5750    accuracy: 26.63% -> 87.97%                                                                                                            
client [0]   loss: 1.8386 -> 0.1959    accuracy: 46.55% -> 94.12%                                                                                                            
client [1]   loss: 6.7608 -> 0.3468    accuracy: 16.33% -> 87.82%                                                                                                            
client [2]   loss: 10.9939 -> 0.4377    accuracy: 1.06% -> 89.89%                                                                                                            
============================== ROUND: 5 ==============================                                                                                                       
client [4]   loss: 2.0939 -> 0.2225    accuracy: 20.67% -> 93.42%                                                                                                            
client [0]   loss: 1.8064 -> 0.2631    accuracy: 31.46% -> 90.54%                                                                                                            
client [1]   loss: 2.8885 -> 0.2825    accuracy: 8.43% -> 91.51%                                                                                                             
client [2]   loss: 4.5274 -> 0.2679    accuracy: 0.46% -> 92.60%                                                                                                             
client [3]   loss: 4.4270 -> 0.1486    accuracy: 0.43% -> 95.82%                                                                                                             
============================== ROUND: 10 ==============================                                                                                                      
client [4]   loss: 2.1493 -> 0.3585    accuracy: 16.14% -> 86.94%                                                                                                            
client [1]   loss: 2.3811 -> 0.4993    accuracy: 10.93% -> 79.72%                                                                                                            
client [0]   loss: 1.8613 -> 0.8447    accuracy: 27.37% -> 74.94%                                                                                                            
client [2]   loss: 3.4015 -> 0.1609    accuracy: 0.99% -> 94.65%                                                                                                             
client [3]   loss: 3.3490 -> 0.3388    accuracy: 1.11% -> 92.69%                                                                                                             
============================== ROUND: 15 ==============================                                                                                                      
client [1]   loss: 2.6276 -> 0.3674    accuracy: 8.43% -> 87.89%                                                                                                             
client [4]   loss: 2.0150 -> 0.2668    accuracy: 23.96% -> 91.52%                                                                                                            
client [0]   loss: 2.0116 -> 3.0784    accuracy: 24.55% -> 70.08%                                                                                                            
client [2]   loss: 2.8202 -> 0.4622    accuracy: 5.75% -> 88.24%                                                                                                             
client [3]   loss: 3.3846 -> 0.1247    accuracy: 0.55% -> 95.45%                                                                                                             
============================== ROUND: 20 ==============================                                                                                                      
client [2]   loss: 2.9784 -> 0.4940    accuracy: 2.44% -> 86.72%                                                                                                             
client [0]   loss: 1.7312 -> 0.1301    accuracy: 41.69% -> 95.91%                                                                                                            
client [1]   loss: 2.5587 -> 0.3527    accuracy: 17.71% -> 85.78%                                                                                                            
client [4]   loss: 2.1443 -> 0.1909    accuracy: 18.05% -> 93.83%                                                                                                            
client [3]   loss: 2.8379 -> 0.2685    accuracy: 3.50% -> 89.86%                                                                                                             
============================== ROUND: 25 ==============================                                                                                                      
client [4]   loss: 2.0997 -> 0.1963    accuracy: 26.38% -> 94.34%                                                                                                            
client [0]   loss: 1.9285 -> 0.1740    accuracy: 38.62% -> 93.86%                                                                                                            
client [1]   loss: 2.6077 -> 4.0139    accuracy: 13.89% -> 52.93%                                                                                                            
client [3]   loss: 2.5480 -> 0.1485    accuracy: 5.28% -> 96.07%                                                                                                             
client [2]   loss: 2.7112 -> 0.4020    accuracy: 5.81% -> 85.73%                                                                                                             
============================== ROUND: 30 ==============================                                                                                                      
client [3]   loss: 2.7312 -> 0.1863    accuracy: 1.41% -> 94.35%                                                                                                             
client [1]   loss: 2.7870 -> 0.3491    accuracy: 6.19% -> 86.11%                                                                                                             
client [0]   loss: 2.1732 -> 0.1655    accuracy: 24.30% -> 93.09%                                                                                                            
client [4]   loss: 2.1457 -> 0.5703    accuracy: 32.80% -> 82.01%                                                                                                            
client [2]   loss: 2.7348 -> 0.2390    accuracy: 7.73% -> 92.27%                                                                                                             
============================== ROUND: 35 ==============================                                                                                                      
client [0]   loss: 2.5101 -> 0.2052    accuracy: 17.90% -> 94.37%                                                                                                            
client [3]   loss: 2.7065 -> 1.2095    accuracy: 4.85% -> 66.40%                                                                                                             
client [2]   loss: 2.6495 -> 0.2455    accuracy: 4.69% -> 92.34%                                                                                                             
client [1]   loss: 2.8506 -> 3.2030    accuracy: 3.69% -> 59.91%                                                                                                             
client [4]   loss: 2.3391 -> 0.2223    accuracy: 32.03% -> 93.16%                                                                                                            
============================== ROUND: 40 ==============================                                                                                                      
client [2]   loss: 2.4990 -> 0.1733    accuracy: 9.45% -> 94.19%                                                                                                             
client [3]   loss: 3.0746 -> 2.1793    accuracy: 0.55% -> 53.62%                                                                                                             
client [4]   loss: 2.2500 -> 3.3475    accuracy: 33.78% -> 63.44%                                                                                                            
client [1]   loss: 2.9611 -> 0.5075    accuracy: 2.50% -> 83.94%                                                                                                             
client [0]   loss: 2.5383 -> 0.2071    accuracy: 14.07% -> 93.35%                                                                                                            
============================== ROUND: 45 ==============================                                                                                                      
client [1]   loss: 2.5209 -> 0.3267    accuracy: 11.39% -> 87.76%                                                                                                            
client [3]   loss: 3.0483 -> 1.5132    accuracy: 2.40% -> 62.47%                                                                                                             
client [2]   loss: 2.6500 -> 0.1485    accuracy: 7.86% -> 95.31%                                                                                                             
client [4]   loss: 2.2953 -> 0.2412    accuracy: 29.36% -> 92.60%                                                                                                            
client [0]   loss: 2.0820 -> 0.2660    accuracy: 29.92% -> 92.07%                                                                                                            
============================== ROUND: 50 ==============================                                                                                                      
client [1]   loss: 2.7341 -> 0.4556    accuracy: 4.28% -> 84.86%                                                                                                             
client [0]   loss: 2.4167 -> 0.2784    accuracy: 15.86% -> 91.56%                                                                                                            
client [2]   loss: 2.3163 -> 0.2385    accuracy: 23.78% -> 92.01%                                                                                                            
client [3]   loss: 2.5137 -> 0.1376    accuracy: 5.90% -> 95.95%                                                                                                             
client [4]   loss: 2.1358 -> 0.2240    accuracy: 32.90% -> 93.47%                                                                                                            
============================== ROUND: 55 ==============================                                                                                                      
client [1]   loss: 2.7601 -> 0.2422    accuracy: 11.52% -> 92.03%                                                                                                            
client [2]   loss: 2.1097 -> 0.2294    accuracy: 32.63% -> 92.27%                                                                                                            
client [3]   loss: 2.0190 -> 3.6271    accuracy: 21.07% -> 45.82%                                                                                                            
client [4]   loss: 2.5639 -> 0.2191    accuracy: 13.06% -> 93.21%                                                                                                            
client [0]   loss: 2.4030 -> 0.3208    accuracy: 16.88% -> 90.79%                                                                                                            
============================== ROUND: 60 ==============================                                                                                                      
client [2]   loss: 2.2432 -> 0.2971    accuracy: 23.91% -> 92.01%                                                                                                            
client [0]   loss: 2.2397 -> 0.5671    accuracy: 17.39% -> 88.24%                                                                                                            
client [3]   loss: 2.1710 -> 0.7915    accuracy: 15.36% -> 80.90%                                                                                                            
client [1]   loss: 2.3377 -> 2.6697    accuracy: 20.21% -> 67.81%                                                                                                            
client [4]   loss: 2.3376 -> 0.3216    accuracy: 15.06% -> 89.36%                                                                                                            
============================== ROUND: 65 ==============================                                                                                                      
client [0]   loss: 1.9603 -> 0.2562    accuracy: 23.02% -> 94.37%                                                                                                            
client [3]   loss: 2.2718 -> 0.3197    accuracy: 12.84% -> 91.40%                                                                                                            
client [1]   loss: 2.1692 -> 0.3038    accuracy: 20.93% -> 89.99%                                                                                                            
client [2]   loss: 2.1079 -> 2.7872    accuracy: 36.13% -> 53.63%                                                                                                            
client [4]   loss: 2.3186 -> 0.1497    accuracy: 13.42% -> 95.63%                                                                                                            
============================== ROUND: 70 ==============================                                                                                                      
client [3]   loss: 2.3410 -> 0.4141    accuracy: 21.99% -> 93.98%                                                                                                            
client [0]   loss: 2.1085 -> 1.4086    accuracy: 19.95% -> 61.38%                                                                                                            
client [4]   loss: 2.1848 -> 0.3828    accuracy: 18.77% -> 88.59%                                                                                                            
client [1]   loss: 2.3297 -> 0.8599    accuracy: 21.13% -> 78.21%                                                                                                            
client [2]   loss: 2.5172 -> 0.2767    accuracy: 21.20% -> 92.47%                                                                                                            
============================== ROUND: 75 ==============================                                                                                                      
client [3]   loss: 2.3787 -> 1.2833    accuracy: 20.52% -> 57.74%                                                                                                            
client [4]   loss: 2.0036 -> 0.2052    accuracy: 22.83% -> 93.68%                                                                                                            
client [1]   loss: 2.5375 -> 0.2877    accuracy: 19.16% -> 90.32%                                                                                                            
client [0]   loss: 2.1939 -> 3.4377    accuracy: 14.32% -> 24.30%                                                                                                            
client [2]   loss: 2.3384 -> 0.2447    accuracy: 28.53% -> 92.73%                                                                                                            
============================== ROUND: 80 ==============================                                                                                                      
client [3]   loss: 2.4453 -> 0.3239    accuracy: 15.48% -> 89.86%                                                                                                            
client [1]   loss: 2.5902 -> 0.2439    accuracy: 11.26% -> 92.30%                                                                                                            
client [2]   loss: 2.5651 -> 0.6339    accuracy: 28.67% -> 88.71%                                                                                                            
client [0]   loss: 2.2678 -> 0.2631    accuracy: 13.81% -> 93.35%                                                                                                            
client [4]   loss: 1.7584 -> 0.2559    accuracy: 38.15% -> 91.47%                                                                                                            
============================== ROUND: 85 ==============================                                                                                                      
client [3]   loss: 2.4259 -> 0.2830    accuracy: 15.17% -> 93.73%                                                                                                            
client [2]   loss: 2.6286 -> 0.2532    accuracy: 20.08% -> 92.47%                                                                                                            
client [0]   loss: 2.2157 -> 0.3338    accuracy: 17.90% -> 91.05%                                                                                                            
client [4]   loss: 1.6188 -> 0.8666    accuracy: 45.35% -> 67.61%                                                                                                            
client [1]   loss: 2.4905 -> 0.2734    accuracy: 9.68% -> 90.32%                                                                                                             
============================== ROUND: 90 ==============================                                                                                                      
client [4]   loss: 1.5608 -> 0.2923    accuracy: 50.23% -> 90.44%                                                                                                            
client [2]   loss: 2.7636 -> 0.2426    accuracy: 19.62% -> 93.20%                                                                                                            
client [1]   loss: 2.2936 -> 0.3042    accuracy: 12.64% -> 89.53%                                                                                                            
client [0]   loss: 2.1566 -> 17.2544    accuracy: 22.76% -> 70.08%                                                                                                           
client [3]   loss: 2.8329 -> 0.2556    accuracy: 7.99% -> 92.51%                                                                                                             
============================== ROUND: 95 ==============================                                                                                                      
client [2]   loss: 3.1050 -> 0.2737    accuracy: 11.89% -> 92.01%                                                                                                            
client [3]   loss: 3.1617 -> 11.1414    accuracy: 7.25% -> 42.44%                                                                                                            
client [0]   loss: 1.7206 -> 6.0476    accuracy: 35.81% -> 48.59%                                                                                                            
client [1]   loss: 2.0266 -> 0.3245    accuracy: 23.83% -> 90.65%                                                                                                            
client [4]   loss: 1.5839 -> 1.3047    accuracy: 47.46% -> 66.79%                                                                                                            
Training... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:02:54
============================== TESTING ==============================                                                                                                        
Testing... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:01
==================== RESULTS ====================                                                                                                                            
loss: 2.3347    accuracy: 23.50%                                                                                                                                             
SCAFFOLD achieved 10.0% accuracy(13.78%) at epoch: 0                                                                                                                         
SCAFFOLD achieved 20.0% accuracy(20.21%) at epoch: 64                                                                                                                        
(scaffold) xzhao181@en4228312l:~/DP_FedScaff_Stein$ 